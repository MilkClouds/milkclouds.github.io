---
layout: post
title: '피보나치 수의 심오함'
author: MilkClouds
comments: true
date: 2021-02-04 12:49
tags: [math]
use_math: true
---

피보나치 수는 게임 이론, 선형대수학, 조합론, 정수론에 이르기까지 엄청난 범위의 학문에서 다루고 응용하는 수이다. 피보나치 수에 대해서는 정말 공부하고 공부해도 공부할 내용이 또 나온다. 지식이 늘어갈수록 더 놀라움을 느낄 수밖에 없는 수이다.  

필자는 교수도 아니고 대학원생도 아니고 심지어 아직 학부생조차 아니다. 1개월 후 대학교 입학하는 이제 고등학교를 졸업하는 햇병아리이다. 그래서 이 글에 쓰인 사소한 표현 하나하나도 크게 학술적으로 고민해서 고른 단어가 아니고, 부적절한 단어나 틀린 단어가 끼어 있을수도 있다. 대강의 맥락은 어느정도 맞을 테니 감안하고 봐주면 좋겠다.  


#### 1. 피보나치 님 게임  

피보나치 님 게임이라는 게임이 있다. 게임 이론에서 다루는 필승전략이 존재하는 게임 중 하나이다. (Nim Game의 일종이다.)  

이 게임의 필승 전략은 제켄도르프 분해와 밀접한 연관이 있는데, 이 제켄도르프 분해는 "피보나치 수를 이용한 진법"으로 나타내는 방법과 같다. (2진법, 10진법 할 때의 그 진법이다.)  

관련된 BOJ 문제로는 [Fibonacci Game](https://www.acmicpc.net/problem/2373), [수학 게임](https://www.acmicpc.net/problem/2862)이 있다.


#### 2. 유클리드 호제법과의 관계  

유클리드 호제법의 시행 횟수를 최대한으로 만드는 일정 범위 내의 두 수는 피보나치 수와 연관이 있다.  

이건 그냥 혼자서 생각한 내용이다.  


#### 3. 피보나치 수열과 아크코탄젠트 함수  

[피보나치 수열과 arccot 함수](https://mathstorehouse.com/archives/mathematics/others/high-school-math/3808/)  


#### 4. 피보나치 수열과 삼각함수  

[피보나치 수열과 삼각함수](https://mathstorehouse.com/archives/mathematics/discrete-math/combinatorics/4921/)  

오일러 공식, 사인/코사인의 복소수 정의역 정의에 대해 알아두면 어렵지 않게 이해할 수 있다.  


#### 5. 피보나치 수열과 행렬, 그래프 이론(인접행렬)  

[피보나치 수열과 그래프](https://mathstorehouse.com/archives/mathematics/discrete-math/graph-theory/4471/)  

피보나치 수에 대해 행렬이론과 조합론의 두 가지 관점으로 설명하는데, 각각의 관점에 대해 아래에서 덧붙여 설명하겠다.  


###### 5.1 행렬곱을 이용한 설명  
행렬곱에 대한, 단순한 정의에서 벗어난 더 깊은 이해를 해두면 위 글도 이해하기 편리할 것이다. 행렬 곱셈은, 어떤 시각으로 보든 "계산 결과"는 같지만, 여러 가지 시각으로 다르게 바라볼 수 있으며, 이러한 약간의 시각 차이로도 이해에 큰 도움을 줄 수 있다. 아래 두 개의 게시물을 참고하면 좋다. 둘 다 비슷한 내용을 담고 있다.      

[행렬 곱에 대한 또 다른 시각(공돌이의 수학정리노트)](https://angeloyeo.github.io/2020/09/08/matrix_multiplication.html)
[행렬곱셈(Gilbert Strang 교수님의 MIT 무료 유튜브 강의 기반 설명)](https://twlab.tistory.com/10?category=668741)  


###### 5.2 그래프 이론을 이용한 조합론적인 설명  

**인접 행렬의 거듭 제곱이 무슨 의미를 갖는가?**  
이것을 알고 있다면 이해가 쉬울 수 있다.  

인접 행렬의 거듭 제곱의 의미는 [여기](https://m.blog.naver.com/sbssbi69/90160704849)에서 대강 확인할 수 있다.  

그리고 $M^n$을 다시 바라보면, 아 이것은 그래프에서 n번 이동했을 때 경우의 수를 나타낸 행렬이구나! 라는 것을 깨달을 수 있으며, 여기다가 뒤에 $e_1$을 곱한 것을, [행렬 곱에 대한 또 다른 시각(공돌이의 수학정리노트)](https://angeloyeo.github.io/2020/09/08/matrix_multiplication.html)에서 알려줬듯 "선형 결합"으로 해석하면 아 1번 노드에서 이동하는 경우의 수만 뽑아왔구나, 라고 해석할 수 있다.

그리고 여기 앞에 $e^T$를 곱한 것은, `4*1` 행렬과 `1*4` 행렬의 곱인데, 벡터의 내적으로 해석할 수 있다. 그럼 $e^T$까지 곱한 "최종 결과"는, 아 1번 노드에서 이동하는 경우의 수를 모두 더했구나! 다른 말로, 1번 노드에서 시작해서 n번 이동하는 경우의 수의 총합이구나! 라는 사실을 알 수 있다.  


#### 6. 행렬곱을 이용한 (위보다 간략한) 설명 2

\[
\begin{align\*}
\begin{bmatrix}
F_{n + 1} & F_n \\
F_n       & F_{n - 1}
\end{bmatrix}
&=
\begin{bmatrix}
F_{2} & F_{1} \\
F_{1} & F_{0}
\end{bmatrix}^n
&=
\begin{bmatrix}
1 & 1 \\
1 & 0
\end{bmatrix}^n
\end{align\*}
\]

`2*2` 행렬의 곱은 대충 `O(1)`에 계산할 수 있고, 이 계산을 '빠른 거듭제곱 알고리즘'(분할정복)으로 계산하면, `F_n`을 `O(logn)`으로 계산할 수 있다.   


추가적인 설명이 필요하다면 "빠른 거듭제곱 알고리즘" 이런 키워드로 구글링하면 된다.  